<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Offline Email Template Generator</title>
  <style>
    /* ===== App UI (not the email) ===== */
    :root { --bg:#0b1220; --panel:#131c2c; --ink:#e8eefc; --muted:#9fb0d0; --accent:#6da7ff; --ok:#15b374; --warn:#f59e0b; }
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Helvetica,Arial,sans-serif;}
    header{padding:20px 16px;border-bottom:1px solid #1f2a44;background:linear-gradient(0deg,#0b1220,#0e1526);} 
    h1{font-size:20px;margin:0}
    .wrap{display:grid;grid-template-columns:340px 1fr;gap:16px;padding:16px;}
    .card{background:var(--panel);border:1px solid #1f2a44;border-radius:14px;overflow:hidden}
    .card h2{font-size:14px;letter-spacing:.02em;text-transform:uppercase;color:var(--muted);margin:0;padding:14px 14px;border-bottom:1px solid #1f2a44}
    .card .body{padding:14px;}
    label{display:block;font-size:12px;color:var(--muted);margin:8px 0 6px}
    input, select, textarea{width:100%;box-sizing:border-box;background:#0c1424;color:var(--ink);border:1px solid #263351;border-radius:10px;padding:10px 12px;font:inherit}
    textarea{min-height:92px;resize:vertical}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .actions{display:flex;flex-wrap:wrap;gap:8px;margin-top:12px}
    button{cursor:pointer;border:1px solid #2a3a5f;background:#10203a;color:var(--ink);border-radius:10px;padding:10px 12px;font-weight:600}
    button.primary{background:var(--accent);color:#071225;border-color:#6da7ff}
    button.good{background:var(--ok);color:#04130c;border-color:#0e8556}
    button.warn{background:var(--warn);color:#140a02;border-color:#a76604}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    iframe{width:100%;height:520px;background:white;border:0;border-radius:10px}
    code, .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
    .small{font-size:12px;color:var(--muted)}
  </style>
</head>
<body>
  <header>
    <h1>Offline Email Template Generator</h1>
    <div class="small">Build responsive, table‑based HTML emails (1–3 columns and an overlay/card layout). No external libraries.</div>
  </header>

  <div class="wrap">
    <!-- Controls -->
    <section class="card">
      <h2>Content & Settings</h2>
      <div class="body">
        <label for="layout">Layout</label>
        <select id="layout">
          <option value="one">1‑Column</option>
          <option value="two">2‑Column</option>
          <option value="three">3‑Column</option>
          <option value="overlay">Overlay Card (Template 4)</option>
        </select>

        <div class="row">
          <div>
            <label for="brandColor">Brand Color (hex)</label>
            <input id="brandColor" type="text" value="#1e88e5" />
          </div>
          <div>
            <label for="accentColor">Accent Color (hex)</label>
            <input id="accentColor" type="text" value="#ffc107" />
          </div>
        </div>

        <div class="row">
          <div>
            <label for="bgColor">Background (page) Color</label>
            <input id="bgColor" type="text" value="#f0f3f8" />
          </div>
          <div>
            <label for="cardBg">Card/Panel Background</label>
            <input id="cardBg" type="text" value="#ffffff" />
          </div>
        </div>

        <label for="logoUrl">Logo URL (or data URI)</label>
        <input id="logoUrl" placeholder="https://example.com/logo.png" />

        <label for="preheader">Preheader (hidden preview text)</label>
        <input id="preheader" value="This is the preview text that appears beside your subject line." />

        <label for="headline">Headline</label>
        <input id="headline" value="Welcome to our newsletter" />

        <label for="intro">Intro / Body (Column A)</label>
        <textarea id="intro">Thanks for being here! This is a responsive, offline HTML email you can paste into your ESP or send manually.</textarea>

        <div class="row">
          <div>
            <label for="colB">Column B</label>
            <textarea id="colB">Use this for highlights, secondary stories, or a sidebar.</textarea>
          </div>
          <div>
            <label for="colC">Column C</label>
            <textarea id="colC">A third column for links or notes. Stacks on mobile.</textarea>
          </div>
        </div>

        <label for="ctaText">CTA Button Text</label>
        <input id="ctaText" value="Read more" />

        <label for="ctaUrl">CTA Button URL</label>
        <input id="ctaUrl" value="https://example.com" />

        <label for="footer">Footer</label>
        <textarea id="footer">You received this email because you opted in at our website. • 123 Example St, Town, ST 00000 • <a href="#">Unsubscribe</a></textarea>

        <div class="actions">
          <button class="primary" onclick="generate()">Generate HTML</button>
          <button onclick="copyOut()">Copy</button>
          <button class="good" onclick="downloadOut()">Download .html</button>
          <button class="warn" onclick="previewOut()">Preview</button>
        </div>
      </div>
    </section>

    <!-- Output & Preview -->
    <section class="grid">
      <div class="card">
        <h2>Generated HTML</h2>
        <div class="body">
          <textarea id="output" class="mono" spellcheck="false" placeholder="Click Generate to produce HTML email code..."></textarea>
          <p class="small">Tip: Most email clients prefer a 600px wide main table. The generator inlines critical styles and includes mobile fallbacks.</p>
        </div>
      </div>
      <div class="card">
        <h2>Live Preview (in‑app)</h2>
        <div class="body">
          <iframe id="preview"></iframe>
        </div>
      </div>
    </section>
  </div>

  <script>
    // Utility: escape HTML for safe interpolation into attribute/inline text
    const esc = (s='') => String(s)
      .replaceAll('&','&amp;').replaceAll('<','&lt;')
      .replaceAll('>','&gt;').replaceAll('"','&quot;')
      .replaceAll("'",'&#39;');

    function generate(){
      const layout = document.getElementById('layout').value;
      const brand = document.getElementById('brandColor').value.trim() || '#1e88e5';
      const accent = document.getElementById('accentColor').value.trim() || '#ffc107';
      const pageBg = document.getElementById('bgColor').value.trim() || '#f0f3f8';
      const cardBg = document.getElementById('cardBg').value.trim() || '#ffffff';
      const logo = document.getElementById('logoUrl').value.trim();
      const pre = document.getElementById('preheader').value;
      const h1 = document.getElementById('headline').value;
      const a = document.getElementById('intro').value;
      const b = document.getElementById('colB').value;
      const c = document.getElementById('colC').value;
      const ctaText = document.getElementById('ctaText').value;
      const ctaUrl = document.getElementById('ctaUrl').value;
      const foot = document.getElementById('footer').value;

      const base = buildEmail({ layout, brand, accent, pageBg, cardBg, logo, pre, h1, a, b, c, ctaText, ctaUrl, foot });
      document.getElementById('output').value = base;
    }

    function previewOut(){
      if(!document.getElementById('output').value) generate();
      const html = document.getElementById('output').value;
      const blob = new Blob([html], {type:'text/html'});
      const url = URL.createObjectURL(blob);
      const iframe = document.getElementById('preview');
      iframe.src = url;
    }

    function copyOut(){
      if(!document.getElementById('output').value) generate();
      document.getElementById('output').select();
      document.execCommand('copy');
      alert('HTML copied to clipboard');
    }

    function downloadOut(){
      if(!document.getElementById('output').value) generate();
      const blob = new Blob([document.getElementById('output').value], {type:'text/html'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'email-template.html';
      document.body.appendChild(a); a.click(); a.remove();
      URL.revokeObjectURL(url);
    }

    // Build email string for selected layout (table‑based + inline styles)
    function buildEmail(cfg){
      const {layout, brand, accent, pageBg, cardBg, logo, pre, h1, a, b, c, ctaText, ctaUrl, foot} = cfg;

      // Common CSS placed in <style>; most clients support these. Critical widths are inline on TDs.
      const style = `
      <style>
        /* Web‑safe fonts only */
        @media screen { .external-font { font-family: -apple-system, Segoe UI, Roboto, Arial, sans-serif !important; } }
        /* Mobile stacking */
        @media (max-width: 620px){
          .container{ width:100% !important; }
          .stack{ display:block !important; width:100% !important; }
          .p-sm{ padding-left:16px !important; padding-right:16px !important; }
          .center-sm{ text-align:center !important; }
          .hide-sm{ display:none !important; height:0 !important; overflow:hidden !important; }
        }
        /* Dark mode hint (not all clients) */
        @media (prefers-color-scheme: dark){ .card-bg{ background:#111 !important; color:#eee !important; } }
      </style>`;

      const logoBlock = logo ? `
        <tr>
          <td style="padding:20px 24px 0 24px; text-align:center;">
            <img src="${esc(logo)}" alt="Logo" width="160" style="max-width:160px;height:auto;border:0;display:inline-block;" />
          </td>
        </tr>` : '';

      const headerBlock = `
        <tr>
          <td style="padding:20px 24px 8px 24px; text-align:center; font:700 24px/1.2 Arial, sans-serif; color:#0b1a2a;">
            ${esc(h1)}
          </td>
        </tr>`;

      const cta = ctaText ? `
        <tr>
          <td align="center" style="padding:14px 24px 24px 24px">
            <a href="${esc(ctaUrl)}" style="background:${esc(brand)}; color:#ffffff; text-decoration:none; font:700 16px Arial, sans-serif; padding:12px 22px; border-radius:6px; display:inline-block;">${esc(ctaText)}</a>
          </td>
        </tr>` : '';

      const footerBlock = `
        <tr>
          <td class="card-bg" style="padding:18px 24px; font:12px/1.5 Arial, sans-serif; color:#516179; background:${esc(pageBg)};">
            ${foot}
          </td>
        </tr>`;

      // Column blocks
      const col = (html) => `
        <td class="stack p-sm" width="200" valign="top" style="width:200px; padding:0 12px; font:14px/1.6 Arial, sans-serif; color:#2b3a4c;">
          ${html}
        </td>`;

      const oneCol = `
        <tr>
          <td class="p-sm" style="padding:6px 24px 18px 24px; font:16px/1.7 Arial, sans-serif; color:#2b3a4c;">
            ${a}
          </td>
        </tr>`;

      const twoCol = `
        <tr>
          <td style="padding:6px 12px 18px 12px">
            <table role="presentation" width="100%" cellpadding="0" cellspacing="0">
              <tr>
                ${col(a)}
                ${col(b)}
              </tr>
            </table>
          </td>
        </tr>`;

      const threeCol = `
        <tr>
          <td style="padding:6px 6px 18px 6px">
            <table role="presentation" width="100%" cellpadding="0" cellspacing="0">
              <tr>
                ${col(a)}
                ${col(b)}
                ${col(c)}
              </tr>
            </table>
          </td>
        </tr>`;

      // Overlay/Card section reminiscent of your Template 4
      const overlay = `
        <tr>
          <td style="padding:18px 18px 22px 18px">
            <!-- Background panel -->
            <table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="background:${esc(pageBg)}; border-radius:10px;">
              <tr>
                <!-- Decorative slim column (like a left rail) -->
                <td class="hide-sm" width="16" style="width:16px">&nbsp;</td>
                <td style="padding:22px">
                  <!-- Foreground card -->
                  <table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="background:${esc(cardBg)}; border-radius:14px; box-shadow:0 0 0 1px ${esc(pageBg)} inset;">
                    <tr>
                      <td style="padding:20px; font:16px/1.7 Arial, sans-serif; color:#2b3a4c;">
                        ${a}
                      </td>
                    </tr>
                    ${cta}
                  </table>
                </td>
              </tr>
            </table>
          </td>
        </tr>`;

      // Choose layout body
      let bodyRows = oneCol;
      if(layout === 'two') bodyRows = twoCol;
      if(layout === 'three') bodyRows = threeCol;
      if(layout === 'overlay') bodyRows = overlay;

      // Assemble full document
      const html = `<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="x-apple-disable-message-reformatting">
  <meta name="format-detection" content="telephone=no,email=no,address=no,date=no,url=no">
  ${style}
  <title>Email</title>
</head>
<body style="margin:0; padding:0; background:${esc(pageBg)};">
  <!-- Preheader (hidden) -->
  <div style="display:none; max-height:0; overflow:hidden; opacity:0; mso-hide:all">${esc(pre)}</div>

  <table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="background:${esc(pageBg)}">
    <tr>
      <td align="center" style="padding:20px 12px;">
        <!-- Main container (600px) -->
        <table role="presentation" class="container" cellpadding="0" cellspacing="0" width="600" style="width:600px; background:${esc(cardBg)}; border-radius:16px; box-shadow:0 0 0 1px #e6ecf6 inset;">
          <tr>
            <td style="height:6px; background:${esc(brand)}; border-top-left-radius:16px; border-top-right-radius:16px"></td>
          </tr>
          ${logoBlock}
          ${headerBlock}
          <!-- Divider -->
          <tr><td style="padding:6px 24px"><hr style="border:none;border-top:1px solid #e3e9f3"></td></tr>
          ${bodyRows}
          ${footerBlock}
        </table>

        <!-- Spacing below -->
        <div style="height:30px;line-height:30px">&nbsp;</div>

        <!-- Full‑width footer bar, like Templates 1–3 -->
        <table role="presentation" cellpadding="0" cellspacing="0" width="600" class="container" style="width:600px;">
          <tr>
            <td align="center" style="background:${esc(brand)}; color:#ffffff; font:12px/1.6 Arial, sans-serif; padding:10px 12px; border-radius:10px;">
              &copy; ${new Date().getFullYear()} Your Company • <span style="color:#ffffff">All rights reserved</span>
            </td>
          </tr>
        </table>

      </td>
    </tr>
  </table>
</body>
</html>`;

      return html;
    }

    // Generate an initial sample on load for convenience
    window.addEventListener('DOMContentLoaded', generate);
  </script>
</body>
</html>
